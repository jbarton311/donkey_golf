pull_available_players:
    SELECT a.*, b.current_rank, b.events_played
    from public.pre_tourney a
    left join public.rankings b
      ON a.player=b.player
    ORDER BY current_rank

users_team:
    SELECT a.id, b.* from public.teams a
    INNER JOIN leaderboard b
        ON a.player = b.player
    WHERE a.id = 5
    AND a.tourney_id = (select value from donkey_variables where metric = 'current_tourney_id')

users_team_pre_tourney:
    SELECT * from public.teams
    WHERE id = {0}
    AND tourney_id = (select value from donkey_variables where metric = 'current_tourney_id')

pull_tourney_leaderboard:
    select * from leaderboard
    where tourney_id = (select value from donkey_variables where metric = 'current_tourney_id')

aggregate_team_score:
    SELECT a.id, c.username,
    sum(CAST(b.donkey_score as INT)) as donkey_score,
    sum(CAST(b.missed_cut as INT)) as missed_cut,
    sum(CAST(b.player_left as INT)) as player_left
    from public.teams a
        left join public.leaderboard b
        ON a.player=b.player
        left join public.user c
        ON a.id=c.id
    WHERE a.tourney_id = (select value from donkey_variables where metric = 'current_tourney_id')
    GROUP BY 1,2

calculate_cut_line:
    SELECT pos from public.leaderboard
    WHERE (pos LIKE ('%projected%')
      OR pos LIKE ('%failed to%'))
    AND tourney_id = (select value from donkey_variables where metric = 'current_tourney_id')
    LIMIT 1

determine_current_tourney_id:
    select value from donkey_variables
    where metric = 'current_tourney_id'

golfer_team_count:
    select player, count(*) as team_count from teams
    where tourney_id = (select value from donkey_variables where metric = 'current_tourney_id')
    group by player
    order by 2 DESC

tourney_info:
    SELECT * FROM public.tourney_info
